-- 1. Drop existing objects (if they exist)
DROP TABLE EMPLOYEE2 PURGE;
DROP TABLE DEPARTMENT PURGE;
DROP SEQUENCE ASC_SE;

-- 2. Create DEPARTMENT table
CREATE TABLE DEPARTMENT (
  DEPTNO NUMBER PRIMARY KEY,
  DEPTNAME VARCHAR2(50),
  FLOOR NUMBER
);

-- 3. Populate DEPARTMENT
INSERT ALL
  INTO DEPARTMENT (DEPTNO, DEPTNAME, FLOOR) VALUES (1, 'ADMIN', 2)
  INTO DEPARTMENT (DEPTNO, DEPTNAME, FLOOR) VALUES (2, 'TOYS', 1)
  INTO DEPARTMENT (DEPTNO, DEPTNAME, FLOOR) VALUES (3, 'SHOE', 1)
  INTO DEPARTMENT (DEPTNO, DEPTNAME, FLOOR) VALUES (4, 'LEGAL', 2)
  INTO DEPARTMENT (DEPTNO, DEPTNAME, FLOOR) VALUES (5, 'HR', 2)
  INTO DEPARTMENT (DEPTNO, DEPTNAME, FLOOR) VALUES (6, 'CLOTHES', 1)
  INTO DEPARTMENT (DEPTNO, DEPTNAME, FLOOR) VALUES (7, 'ACCOUNTING', 0)
SELECT * FROM DUAL;

-- 4. Create EMPLOYEE2 table
CREATE TABLE EMPLOYEE2 (
  EMPNO NUMBER PRIMARY KEY,
  MANAGERID NUMBER,
  FIRSTNAME VARCHAR2(50),
  LASTNAME VARCHAR2(50),
  DEPTNO NUMBER REFERENCES DEPARTMENT(DEPTNO),
  SALARY NUMBER
);

-- 5. Create ASC_SE sequence
CREATE SEQUENCE ASC_SE
START WITH 1
INCREMENT BY 1
NOMAXVALUE
NOCACHE;

-- 6. Populate EMPLOYEE2
INSERT ALL
  INTO EMPLOYEE2 VALUES (ASC_SE.NEXTVAL, 1, 'AANI', 'BESANT', 1, 24000)
  INTO EMPLOYEE2 VALUES (ASC_SE.NEXTVAL, 1, 'PRAKASH', 'K', 2, 4000)
  INTO EMPLOYEE2 VALUES (ASC_SE.NEXTVAL, 1, 'BENNY', 'JAYAN', 3, 6000)
  INTO EMPLOYEE2 VALUES (ASC_SE.NEXTVAL, 1, 'ARADHYA', 'P', 4, 19000)
  INTO EMPLOYEE2 VALUES (ASC_SE.NEXTVAL, 1, 'ARYA', 'NITI', 5, 18000)
  INTO EMPLOYEE2 VALUES (ASC_SE.NEXTVAL, 1, 'ARYAAN', 'A', 6, 5000)
  INTO EMPLOYEE2 VALUES (ASC_SE.NEXTVAL, 1, 'WALTER', 'PK', 7, 9000)
  INTO EMPLOYEE2 VALUES (ASC_SE.NEXTVAL, 2, 'RISHIKA', 'PATEL', 2, 1600)
  INTO EMPLOYEE2 VALUES (ASC_SE.NEXTVAL, 3, 'JOHN', 'RUSSO', 3, 3000)
  INTO EMPLOYEE2 VALUES (ASC_SE.NEXTVAL, 4, 'ALAN', 'R', 4, 3000)
  INTO EMPLOYEE2 VALUES (ASC_SE.NEXTVAL, 5, 'JON', 'STARK', 5, 3000)
  INTO EMPLOYEE2 VALUES (ASC_SE.NEXTVAL, 6, 'CLARE', 'RYSWELL', 6, 3000)
  INTO EMPLOYEE2 VALUES (ASC_SE.NEXTVAL, 7, 'ANNA', 'BELL', 7, 3000)
  INTO EMPLOYEE2 VALUES (ASC_SE.NEXTVAL, 4, 'ADIL', 'N', 4, 7000)
  INTO EMPLOYEE2 VALUES (ASC_SE.NEXTVAL, 5, 'AKASH', 'P', 5, 10000)
  INTO EMPLOYEE2 VALUES (ASC_SE.NEXTVAL, 4, 'AKHILESH', 'AB', 4, 11000)
SELECT * FROM DUAL;

-- 7. View results
SELECT * FROM DEPARTMENT;
SELECT * FROM EMPLOYEE2 ORDER BY EMPNO;
QN1.

ALTER TABLE EMPLOYEE2 ADD NAME VARCHAR(100)
UPDATE EMPLOYEE2 SET NAME = FIRSTNAME || ' ' || LASTNAME
SELECT * FROM EMPLOYEE2
SELECT E1.NAME AS EMPLOYEE,E2.NAME AS MANAGER
FROM EMPLOYEE2 E1
LEFT JOIN EMPLOYEE2 E2
ON E1.MANAGERID=E2.EMPNO



SELECT
  E.NAME ,D.DEPTNAME
FROM DEPARTMENT D
JOIN EMPLOYEE2 E ON D.DEPTNO=E.DEPTNO
WHERE E.DEPTNO=2 OR E.DEPTNO=3
SELECT * FROM DEPARTMENT;



